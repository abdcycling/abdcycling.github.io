jQuery.ajaxSetup({cache:!1}),jQuery.fn.slideFade=function(e,a){for(var t,o=0;o<arguments.length;o++)if("number"==typeof arguments[o])t=arguments[o];else var l=arguments[o];t||(t=500),this.animate({opacity:"toggle",height:"toggle"},t,function(){"function"!=typeof l&&(l=function(){}),l.call(this)})},function(p){p.fn.plusGallery=function(e){var r=this;if(0===r.length)return!1;var u={imagePath:"images/plusgallery",type:"google",albumTitle:!1,albumLimit:16,limit:30,apiKey:"",exclude:null,include:null,imageData:null,imgArray:[],titleArray:[],t:"",idx:0,imgCount:0,imgTotal:0,winWidth:1024,touch:!1,titleText:"",init:function(){var e=p(document);"ontouchstart"in document.documentElement&&(window.scrollTo(0,1),u.touch=!0),u.winWidth=p(window).width(),p("#pgzoomview").remove(),e.off("click",".pgalbumlink, #pgthumbhome, .pgthumb, .pgzoomarrow, .pgzoomclose, #pgzoomview, #pgzoomslide, .pgzoomimg"),u.getDataAttr(),u.writeHTML(),null!==u.albumId||"instagram"==u.type||"local"==u.type&&!u.imageData.hasOwnProperty("albums")?u.loadSingleAlbum():"local"==u.type?u.parseAlbumData(u.imageData):u.loadAlbumData(),e.on("click",".pgalbumlink",function(e){e.preventDefault(),p(this).append('<span class="pgloading"></span>');var a=p(this).children("span").html();if("local"==u.type){var t=p(this).attr("data-album-index").replace("http://","").replace("//","").replace("https://","");u.parseData(u.imageData.albums[t],a)}else{var o=this.href;u.loadGallery(o,a)}}),e.on("click","#pgthumbhome",function(e){e.preventDefault(),p("#pgthumbview").slideFade(700),p("#pgalbums").slideFade(700)}),e.on("click",".pgthumb",function(e){e.preventDefault();var a=p(".pgthumb").index(this);u.loadZoom(a)}),e.on("click",".pgzoomarrow",function(e){e.preventDefault();var a=this.rel;return u.prevNext(a),!1}),e.on("click",".pgzoomclose",function(e){e.preventDefault(),u.unloadZoom()}),e.on("click","#pgzoomview",function(e){e.preventDefault(),u.unloadZoom()}),e.on("click","#pgzoomslide",function(){u.unloadZoom()}),e.on("click",".pgzoomimg",function(){return p(this).attr("id").replace("pgzoomimg","")<u.imgTotal-1&&u.prevNext("next"),!1}),clearTimeout(u.t)},getDataAttr:function(){var e=r.attr("data-type");if(!e)return alert("You must enter a data type."),!1;if(u.type=e,e=r.attr("data-userid"))u.userId=e;else if("local"!=u.type)return alert("You must enter a valid User ID"),!1;(e=r.attr("data-limit"))&&(u.limit=e),(e=r.attr("data-album-limit"))&&(u.albumLimit=e),(e=r.attr("data-exclude"))&&(u.exclude=e.split(",")),(e=r.attr("data-include"))&&(u.include=e.split(",")),(e=r.attr("data-api-key"))&&(u.apiKey=e),(e=r.attr("data-access-token"))&&(u.accessToken=e),(e=r.attr("data-album-id"))?(u.albumId=e,titleAttr=r.attr("data-album-title"),"true"==titleAttr?u.albumTitle=!0:u.albumTitle=!1):(u.albumTitle=!0,u.albumId=null),e=r.attr("data-credit"),u.credit="false"!=e,(e=r.attr("data-image-path"))&&(u.imagePath=e),(e=r.attr("data-image-data"))&&(u.imageData=JSON.parse(e))},writeHTML:function(){var e;u.touch?(e="touch",r.addClass("touch")):(e="no-touch",r.addClass("no-touch")),r.append('<ul id="pgalbums" class="clearfix"></ul><div id="pgthumbview"><ul id="pgthumbs" class="clearfix"></ul></div>'),p("body").prepend('<div id="pgzoomview" class="pg '+e+'"><a href="#" rel="previous" id="pgzoomclose" title="Close">Close</a><a href="#" rel="previous" id="pgprevious" class="pgzoomarrow" title="previous">Previous</a><a href="#" rel="next" id="pgnext" class="pgzoomarrow" title="Next">Next</a><div id="pgzoomscroll"><ul id="pgzoom"></ul></div></div>'),r.addClass("pg"),!0===u.credit&&r.append('<div id="pgcredit"><a href="http://www.plusgallery.net" target="_blank" title="Powered by +GALLERY"><span>+</span>Gallery</a></div>'),!0===u.albumTitle&&p("#pgthumbview").prepend('<ul id="pgthumbcrumbs" class="clearfix"><li id="pgthumbhome">&laquo;</li></ul>')},parseAlbumData:function(e){var a,t,o,l,i;switch(r.addClass("loaded"),u.type){case"google":a=e.feed.entry,(t=a.length)>u.albumLimit&&(t=u.albumLimit),0<t?p.each(a,function(e,a){e<t&&(l=a.title.$t,i=a.link[0].href,o=(o=a.media$group.media$thumbnail[0].url).replace("s160","s210"),u.loadAlbums(l,o,i,e))}):alert("There are either no results for albums with this user ID or there was an error loading the data. \n"+i);break;case"flickr":a=e.photosets.photoset,(t=a.length)>u.albumLimit&&(t=u.albumLimit),0<t?p.each(a,function(e,a){e<t&&(l=a.title._content,o="http://farm"+a.farm+".staticflickr.com/"+a.server+"/"+a.primary+"_"+a.secret+"_n.jpg",i="http://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos&api_key="+u.apiKey+"&photoset_id="+a.id+"=&format=json&jsoncallback=?",u.loadAlbums(l,o,i))}):alert("There are either no results for albums with this user ID or there was an error loading the data. \n"+i);break;case"facebook":a=e.data,(t=a.length)>u.albumLimit&&(t=u.albumLimit),0<t?p.each(a,function(e,a){e<t&&(l=a.name,i="https://graph.facebook.com/"+a.id+"/photos?limit="+u.limit+"&access_token="+u.accessToken,o="http://graph.facebook.com/"+a.id+"/picture?type=album",u.loadAlbums(l,o,i))}):alert("There are either no results for albums with this user ID or there was an error loading the data. \n"+albumURL);break;case"local":a=e.albums,(t=a.length)>u.albumLimit&&(t=u.albumLimit),0<t?p.each(a,function(e,a){e<t&&(l=a.title,o=a.images[0].th,i="http://"+e,u.loadAlbums(l,o,i))}):alert("There are no albums available in the specified JSON.")}},loadAlbumData:function(){var e;switch(u.type){case"google":e="https://picasaweb.google.com/data/feed/base/user/"+u.userId+"?alt=json&kind=album&hl=en_US&max-results="+u.albumLimit+"&callback=?";break;case"flickr":e="http://api.flickr.com/services/rest/?&method=flickr.photosets.getList&api_key="+u.apiKey+"&user_id="+u.userId+"&format=json&jsoncallback=?";break;case"facebook":e="https://graph.facebook.com/"+u.userId+"/albums?limit="+u.albumLimit+"&access_token="+u.accessToken+"&callback=?";break;case"instagram":case"local":e=null;break;default:alert("Please define a gallery type.")}p.getJSON(e,function(e){u.parseAlbumData(e)})},loadAlbums:function(e,a,t){var o,l=!0;null!==u.exclude&&p.each(u.exclude,function(e,a){0<t.indexOf(a)&&(l=!1)}),null!==u.include&&(l=!1,p.each(u.include,function(e,a){0<t.indexOf(a)&&(l=!0)})),l&&(o="facebook"==u.type||"flickr"==u.type?'<img src="'+u.imagePath+'/square.png" style="background-image: url('+a+');" title="'+e+'" title="'+e+'" class="pgalbumimg">':'<img src="'+a+'" title="'+e+'" title="'+e+'" class="pgalbumimg">',"local"==u.type?p("#pgalbums").append('<li class="pgalbumthumb"><a href="#" data-album-index="'+t+'" class="pgalbumlink">'+o+'<span class="pgalbumtitle">'+e+'</span><span class="pgplus">+</span></a></li>'):p("#pgalbums").append('<li class="pgalbumthumb"><a href="'+t+'" class="pgalbumlink">'+o+'<span class="pgalbumtitle">'+e+'</span><span class="pgplus">+</span></a></li>'))},loadSingleAlbum:function(){var e;switch(u.type){case"google":e="https://picasaweb.google.com/data/feed/base/user/"+u.userId+"/albumid/"+u.albumId+"?alt=json&hl=en_US",u.loadGallery(e);break;case"flickr":e="http://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos&api_key="+u.apiKey+"&photoset_id="+u.albumId+"=&format=json&jsoncallback=?",u.loadGallery(e);break;case"facebook":e="https://graph.facebook.com/"+u.albumId+"/photos?limit="+u.limit+"&access_token="+u.accessToken,u.loadGallery(e);break;case"instagram":e="https://api.instagram.com/v1/users/"+u.userId+"/media/recent/?access_token="+u.accessToken+"&count="+u.limit,u.loadGallery(e);break;case"local":u.parseData(u.imageData)}r.addClass("loaded"),p("#pgthumbhome").hide()},loadGallery:function(e,a){u.imgArray=[],u.titleArray=[],p("#pgzoom").empty(),p.ajax({url:e,cache:!1,dataType:"jsonp",success:function(e){u.parseData(e,a)},error:function(e,a,t){console.log("Error: \njqXHR:"+e+"\ntextStatus: "+a+"\nerrorThrown: "+t)}})},parseData:function(e,a){var l,i,r,s,c,n="",m=0;switch(p(".crumbtitle").remove(),p("#pgthumbs").empty(),void 0===a&&(a="&nbsp;"),p("#pgthumbcrumbs").append('<li class="crumbtitle">'+a+"</li>"),u.type){case"google":objPath=e.feed.entry;break;case"flickr":objPath=e.photoset.photo;break;case"facebook":case"instagram":objPath=e.data;break;case"local":objPath=e.images}u.imgTotal=objPath.length,u.limit<u.imgTotal&&(u.imgTotal=u.limit),0===u.imgTotal&&alert("Please check your photo permissions,\nor make sure there are photos in this gallery."),c=1100<u.winWidth?(s=1024,"_b"):620<u.winWidth?(s=768,"_b"):(s=540,"_z"),p.each(objPath,function(e,a){if(e<u.limit){switch(u.type){case"google":l=a.title.$t;var t=(i=a.media$group.media$content[0].url).lastIndexOf("/"),o=i.substring(t);i=i.replace(o,"/s"+s+o),r=(r=a.media$group.media$thumbnail[1].url).replace("s144","s160-c");break;case"flickr":l=a.title,i="http://farm"+a.farm+".staticflickr.com/"+a.server+"/"+a.id+"_"+a.secret+c+".jpg",r="http://farm"+a.farm+".staticflickr.com/"+a.server+"/"+a.id+"_"+a.secret+"_q.jpg";break;case"facebook":l=a.name,i=a.images[1].source,r=u.imagePath+"/square.png",n=' style="background: url('+a.images[3].source+') no-repeat 50% 50%; background-size: cover;"';break;case"instagram":null!==a.caption&&(l=a.caption.text),i=a.images.standard_resolution.url,r=a.images.low_resolution.url;break;case"local":null!==a.caption&&(l=a.caption),i=a.src,r=a.th}l||(l=""),u.imgArray[e]=i,u.titleArray[e]=l,p("#pgthumbs").append('<li class="pgthumb"><a href="'+i+'"><img src="'+r+'" id="pgthumbimg'+e+'" class="pgthumbimg" alt="'+l+'" title="'+l+'"'+n+"></a></li>"),p("#pgthumbimg"+e).load(function(){++m==u.imgTotal&&(p("#pgalbums").slideFade(700,function(){p(".pgalbumthumb .pgloading").remove()}),p("#pgthumbview").slideFade(700))})}})},zoomIdx:null,zoomImagesLoaded:[],zoomScrollDir:null,zoomScrollLeft:0,loadZoom:function(a){u.zoomIdx=a,u.winWidth=p(window).width();var e=p("#pgzoomview"),t=(p("#pgzoomscroll"),p("#pgprevious")),o=p("#pgnext"),l=(p("#pgzoom"),""),i=u.imgArray.length;e.addClass("fixed"),0===a&&t.hide(),a==i-1&&o.hide();var r=u.imgArray.length*u.winWidth;p("#pgzoom").width(r);var s=parseInt(a*u.winWidth);e.fadeIn(function(){p(window).on("resize",u.resizeZoom),p.each(u.imgArray,function(e){l=l+'<li class="pgzoomslide loading" id="pgzoomslide'+e+'" style="width: '+u.winWidth+'px;"><img src="'+u.imagePath+'/square.gif" class="pgzoomspacer"><span class="pgzoomcaption">'+u.titleArray[e]+"</span></li>",e+1==u.imgArray.length&&(p("#pgzoom").html(l),u.zoomKeyPress(),p("#pgzoomscroll").scrollLeft(s),u.zoomScrollLeft=s,u.loadZoomImg(a),u.zoomScroll(),0<=a-1&&u.loadZoomImg(a-1),a+1<u.imgArray.length&&u.loadZoomImg(a+1))})})},loadZoomImg:function(e){0===p("#pgzoomimg"+e).length&&(p("#pgzoomslide"+e+" .pgzoomspacer").after('<img src="'+u.imgArray[e]+'" data-src="'+u.imgArray[e]+'" title="'+u.titleArray[e]+'" alt="'+u.titleArray[e]+'" id="pgzoomimg'+e+'" class="pgzoomimg">'),p("#pgzoomimg"+e).load(function(){p(this).addClass("active")}))},zoomScroll:function(){var o=p("#pgprevious"),l=p("#pgnext"),i=!0;p("#pgzoomscroll").on("scroll",function(){currentScrollLeft=p(this).scrollLeft(),!0===i&&(i=!1,setTimeout(function(){if(0===currentScrollLeft?o.fadeOut():o.fadeIn(),currentScrollLeft>=(u.imgTotal-1)*u.winWidth?l.fadeOut():l.fadeIn(),20<currentScrollLeft%u.zoomScrollLeft||0<currentScrollLeft&&0===u.zoomScrollLeft){u.zoomScrollLeft=currentScrollLeft;var e=u.zoomScrollLeft/u.winWidth,a=Math.ceil(e),t=Math.floor(e);u.zoomImagesLoaded[a]||u.loadZoomImg(a),u.zoomImagesLoaded[t]||u.loadZoomImg(t)}i=!0},200))})},zoomKeyPress:function(){p(document).on("keyup","body",function(e){27==e.which?u.unloadZoom():37==e.which?u.prevNext("previous"):39==e.which&&u.prevNext("next")})},resizeZoom:function(){u.winWidth=p(window).width();var e=u.imgArray.length*u.winWidth;p("#pgzoom").width(e),p(".pgzoomslide").width(u.winWidth);var a=parseInt(u.zoomIdx*u.winWidth);p("#pgzoomscroll").scrollLeft(a)},unloadZoom:function(){p(document).off("keyup","body"),p(window).off("resize",u.resizeZoom),p("#pgzoomscroll").off("scroll"),p("#pgzoomview").fadeOut(function(){p("#pgzoom").empty(),p("#pgzoomview").off("keyup"),p("#pgzoomview").removeClass("fixed")})},prevNext:function(e){var a=p("#pgzoomscroll").scrollLeft()/u.winWidth;u.zoomIdx="previous"==e?Math.round(a)-1:Math.round(a)+1;var t=u.zoomIdx*u.winWidth;p("#pgzoomscroll").stop().animate({scrollLeft:t})}};p.extend(u,e),u.init()}}(jQuery);