jQuery.ajaxSetup({cache:!1}),jQuery.fn.slideFade=function(e,a){for(var t,o=0;o<arguments.length;o++)if("number"==typeof arguments[o])t=arguments[o];else var l=arguments[o];t||(t=500),this.animate({opacity:"toggle",height:"toggle"},t,function(){"function"!=typeof l&&(l=function(){}),l.call(this)})},function(e){e.fn.plusGallery=function(a){var t=this;if(0===t.length)return!1;var o={imagePath:"images/plusgallery",type:"google",albumTitle:!1,albumLimit:16,limit:30,apiKey:"",exclude:null,include:null,imageData:null,imgArray:[],titleArray:[],t:"",idx:0,imgCount:0,imgTotal:0,winWidth:1024,touch:!1,titleText:"",init:function(){var a=e(document);"ontouchstart"in document.documentElement&&(window.scrollTo(0,1),o.touch=!0),o.winWidth=e(window).width(),e("#pgzoomview").remove(),a.off("click",".pgalbumlink, #pgthumbhome, .pgthumb, .pgzoomarrow, .pgzoomclose, #pgzoomview, #pgzoomslide, .pgzoomimg"),o.getDataAttr(),o.writeHTML(),null!==o.albumId||"instagram"==o.type||"local"==o.type&&!o.imageData.hasOwnProperty("albums")?o.loadSingleAlbum():"local"==o.type?o.parseAlbumData(o.imageData):o.loadAlbumData(),a.on("click",".pgalbumlink",function(a){a.preventDefault(),e(this).append('<span class="pgloading"></span>');var t=e(this).children("span").html();if("local"==o.type){var l=e(this).attr("data-album-index").replace("http://","").replace("//","").replace("https://","");o.parseData(o.imageData.albums[l],t)}else{var i=this.href;o.loadGallery(i,t)}}),a.on("click","#pgthumbhome",function(a){a.preventDefault(),e("#pgthumbview").slideFade(700),e("#pgalbums").slideFade(700)}),a.on("click",".pgthumb",function(a){a.preventDefault();var t=e(".pgthumb").index(this);o.loadZoom(t)}),a.on("click",".pgzoomarrow",function(e){e.preventDefault();var a=this.rel;return o.prevNext(a),!1}),a.on("click",".pgzoomclose",function(e){e.preventDefault(),o.unloadZoom()}),a.on("click","#pgzoomview",function(e){e.preventDefault(),o.unloadZoom()}),a.on("click","#pgzoomslide",function(){o.unloadZoom()}),a.on("click",".pgzoomimg",function(){return e(this).attr("id").replace("pgzoomimg","")<o.imgTotal-1&&o.prevNext("next"),!1}),clearTimeout(o.t)},getDataAttr:function(){var e=t.attr("data-type");if(!e)return alert("You must enter a data type."),!1;if(o.type=e,e=t.attr("data-userid"))o.userId=e;else if("local"!=o.type)return alert("You must enter a valid User ID"),!1;(e=t.attr("data-limit"))&&(o.limit=e),(e=t.attr("data-album-limit"))&&(o.albumLimit=e),(e=t.attr("data-exclude"))&&(o.exclude=e.split(",")),(e=t.attr("data-include"))&&(o.include=e.split(",")),(e=t.attr("data-api-key"))&&(o.apiKey=e),(e=t.attr("data-access-token"))&&(o.accessToken=e),(e=t.attr("data-album-id"))?(o.albumId=e,titleAttr=t.attr("data-album-title"),"true"==titleAttr?o.albumTitle=!0:o.albumTitle=!1):(o.albumTitle=!0,o.albumId=null),e=t.attr("data-credit"),o.credit="false"!=e,(e=t.attr("data-image-path"))&&(o.imagePath=e),(e=t.attr("data-image-data"))&&(o.imageData=JSON.parse(e))},writeHTML:function(){var a;o.touch?(a="touch",t.addClass("touch")):(a="no-touch",t.addClass("no-touch")),t.append('<ul id="pgalbums" class="clearfix"></ul><div id="pgthumbview"><ul id="pgthumbs" class="clearfix"></ul></div>'),e("body").prepend('<div id="pgzoomview" class="pg '+a+'"><a href="#" rel="previous" id="pgzoomclose" title="Close">Close</a><a href="#" rel="previous" id="pgprevious" class="pgzoomarrow" title="previous">Previous</a><a href="#" rel="next" id="pgnext" class="pgzoomarrow" title="Next">Next</a><div id="pgzoomscroll"><ul id="pgzoom"></ul></div></div>'),t.addClass("pg"),!0===o.credit&&t.append('<div id="pgcredit"><a href="http://www.plusgallery.net" target="_blank" title="Powered by +GALLERY"><span>+</span>Gallery</a></div>'),!0===o.albumTitle&&e("#pgthumbview").prepend('<ul id="pgthumbcrumbs" class="clearfix"><li id="pgthumbhome">&laquo;</li></ul>')},parseAlbumData:function(a){var l,i,r,s,c;switch(t.addClass("loaded"),o.type){case"google":l=a.feed.entry,(i=l.length)>o.albumLimit&&(i=o.albumLimit),i>0?e.each(l,function(e,a){e<i&&(s=a.title.$t,c=a.link[0].href,r=(r=a.media$group.media$thumbnail[0].url).replace("s160","s210"),o.loadAlbums(s,r,c,e))}):alert("There are either no results for albums with this user ID or there was an error loading the data. \n"+c);break;case"flickr":l=a.photosets.photoset,(i=l.length)>o.albumLimit&&(i=o.albumLimit),i>0?e.each(l,function(e,a){e<i&&(s=a.title._content,r="http://farm"+a.farm+".staticflickr.com/"+a.server+"/"+a.primary+"_"+a.secret+"_n.jpg",c="http://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos&api_key="+o.apiKey+"&photoset_id="+a.id+"=&format=json&jsoncallback=?",o.loadAlbums(s,r,c))}):alert("There are either no results for albums with this user ID or there was an error loading the data. \n"+c);break;case"facebook":l=a.data,(i=l.length)>o.albumLimit&&(i=o.albumLimit),i>0?e.each(l,function(e,a){e<i&&(s=a.name,c="https://graph.facebook.com/"+a.id+"/photos?limit="+o.limit+"&access_token="+o.accessToken,r="http://graph.facebook.com/"+a.id+"/picture?type=album",o.loadAlbums(s,r,c))}):alert("There are either no results for albums with this user ID or there was an error loading the data. \n"+albumURL);break;case"local":l=a.albums,(i=l.length)>o.albumLimit&&(i=o.albumLimit),i>0?e.each(l,function(e,a){e<i&&(s=a.title,r=a.images[0].th,c="http://"+e,o.loadAlbums(s,r,c))}):alert("There are no albums available in the specified JSON.")}},loadAlbumData:function(){var a;switch(o.type){case"google":a="https://picasaweb.google.com/data/feed/base/user/"+o.userId+"?alt=json&kind=album&hl=en_US&max-results="+o.albumLimit+"&callback=?";break;case"flickr":a="http://api.flickr.com/services/rest/?&method=flickr.photosets.getList&api_key="+o.apiKey+"&user_id="+o.userId+"&format=json&jsoncallback=?";break;case"facebook":a="https://graph.facebook.com/"+o.userId+"/albums?limit="+o.albumLimit+"&access_token="+o.accessToken+"&callback=?";break;case"instagram":case"local":a=null;break;default:alert("Please define a gallery type.")}e.getJSON(a,function(e){o.parseAlbumData(e)})},loadAlbums:function(a,t,l){var i,r=!0;null!==o.exclude&&e.each(o.exclude,function(e,a){l.indexOf(a)>0&&(r=!1)}),null!==o.include&&(r=!1,e.each(o.include,function(e,a){l.indexOf(a)>0&&(r=!0)})),r&&(i="facebook"==o.type||"flickr"==o.type?'<img src="'+o.imagePath+'/square.png" style="background-image: url('+t+');" title="'+a+'" title="'+a+'" class="pgalbumimg">':'<img src="'+t+'" title="'+a+'" title="'+a+'" class="pgalbumimg">',"local"==o.type?e("#pgalbums").append('<li class="pgalbumthumb"><a href="#" data-album-index="'+l+'" class="pgalbumlink">'+i+'<span class="pgalbumtitle">'+a+'</span><span class="pgplus">+</span></a></li>'):e("#pgalbums").append('<li class="pgalbumthumb"><a href="'+l+'" class="pgalbumlink">'+i+'<span class="pgalbumtitle">'+a+'</span><span class="pgplus">+</span></a></li>'))},loadSingleAlbum:function(){var a;switch(o.type){case"google":a="https://picasaweb.google.com/data/feed/base/user/"+o.userId+"/albumid/"+o.albumId+"?alt=json&hl=en_US",o.loadGallery(a);break;case"flickr":a="http://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos&api_key="+o.apiKey+"&photoset_id="+o.albumId+"=&format=json&jsoncallback=?",o.loadGallery(a);break;case"facebook":a="https://graph.facebook.com/"+o.albumId+"/photos?limit="+o.limit+"&access_token="+o.accessToken,o.loadGallery(a);break;case"instagram":a="https://api.instagram.com/v1/users/"+o.userId+"/media/recent/?access_token="+o.accessToken+"&count="+o.limit,o.loadGallery(a);break;case"local":o.parseData(o.imageData)}t.addClass("loaded"),e("#pgthumbhome").hide()},loadGallery:function(a,t){o.imgArray=[],o.titleArray=[],e("#pgzoom").empty(),e.ajax({url:a,cache:!1,dataType:"jsonp",success:function(e){o.parseData(e,t)},error:function(e,a,t){console.log("Error: \njqXHR:"+e+"\ntextStatus: "+a+"\nerrorThrown: "+t)}})},parseData:function(a,t){var l,i,r,s,c,n="",m=0;switch(e(".crumbtitle").remove(),e("#pgthumbs").empty(),void 0===t&&(t="&nbsp;"),e("#pgthumbcrumbs").append('<li class="crumbtitle">'+t+"</li>"),o.type){case"google":objPath=a.feed.entry;break;case"flickr":objPath=a.photoset.photo;break;case"facebook":case"instagram":objPath=a.data;break;case"local":objPath=a.images}o.imgTotal=objPath.length,o.limit<o.imgTotal&&(o.imgTotal=o.limit),0===o.imgTotal&&alert("Please check your photo permissions,\nor make sure there are photos in this gallery."),o.winWidth>1100?(s=1024,c="_b"):o.winWidth>620?(s=768,c="_b"):(s=540,c="_z"),e.each(objPath,function(a,t){if(a<o.limit){switch(o.type){case"google":l=t.title.$t;var u=(i=t.media$group.media$content[0].url).lastIndexOf("/"),p=i.substring(u);i=i.replace(p,"/s"+s+p),r=(r=t.media$group.media$thumbnail[1].url).replace("s144","s160-c");break;case"flickr":l=t.title,i="http://farm"+t.farm+".staticflickr.com/"+t.server+"/"+t.id+"_"+t.secret+c+".jpg",r="http://farm"+t.farm+".staticflickr.com/"+t.server+"/"+t.id+"_"+t.secret+"_q.jpg";break;case"facebook":l=t.name,i=t.images[1].source,r=o.imagePath+"/square.png",n=' style="background: url('+t.images[3].source+') no-repeat 50% 50%; background-size: cover;"';break;case"instagram":null!==t.caption&&(l=t.caption.text),i=t.images.standard_resolution.url,r=t.images.low_resolution.url;break;case"local":null!==t.caption&&(l=t.caption),i=t.src,r=t.th}l||(l=""),o.imgArray[a]=i,o.titleArray[a]=l,e("#pgthumbs").append('<li class="pgthumb"><a href="'+i+'"><img src="'+r+'" id="pgthumbimg'+a+'" class="pgthumbimg" alt="'+l+'" title="'+l+'"'+n+"></a></li>"),e("#pgthumbimg"+a).load(function(){++m==o.imgTotal&&(e("#pgalbums").slideFade(700,function(){e(".pgalbumthumb .pgloading").remove()}),e("#pgthumbview").slideFade(700))})}})},zoomIdx:null,zoomImagesLoaded:[],zoomScrollDir:null,zoomScrollLeft:0,loadZoom:function(a){o.zoomIdx=a,o.winWidth=e(window).width();var t=e("#pgzoomview"),l=(e("#pgzoomscroll"),e("#pgprevious")),i=e("#pgnext"),r=(e("#pgzoom"),""),s=o.imgArray.length;t.addClass("fixed"),0===a&&l.hide(),a==s-1&&i.hide();var c=o.imgArray.length*o.winWidth;e("#pgzoom").width(c);var n=parseInt(a*o.winWidth);t.fadeIn(function(){e(window).on("resize",o.resizeZoom),e.each(o.imgArray,function(t){r=r+'<li class="pgzoomslide loading" id="pgzoomslide'+t+'" style="width: '+o.winWidth+'px;"><img src="'+o.imagePath+'/square.gif" class="pgzoomspacer"><span class="pgzoomcaption">'+o.titleArray[t]+"</span></li>",t+1==o.imgArray.length&&(e("#pgzoom").html(r),o.zoomKeyPress(),e("#pgzoomscroll").scrollLeft(n),o.zoomScrollLeft=n,o.loadZoomImg(a),o.zoomScroll(),a-1>=0&&o.loadZoomImg(a-1),a+1<o.imgArray.length&&o.loadZoomImg(a+1))})})},loadZoomImg:function(a){0===e("#pgzoomimg"+a).length&&(e("#pgzoomslide"+a+" .pgzoomspacer").after('<img src="'+o.imgArray[a]+'" data-src="'+o.imgArray[a]+'" title="'+o.titleArray[a]+'" alt="'+o.titleArray[a]+'" id="pgzoomimg'+a+'" class="pgzoomimg">'),e("#pgzoomimg"+a).load(function(){e(this).addClass("active")}))},zoomScroll:function(){var a=e("#pgprevious"),t=e("#pgnext"),l=!0;e("#pgzoomscroll").on("scroll",function(){currentScrollLeft=e(this).scrollLeft(),!0===l&&(l=!1,setTimeout(function(){if(0===currentScrollLeft?a.fadeOut():a.fadeIn(),currentScrollLeft>=(o.imgTotal-1)*o.winWidth?t.fadeOut():t.fadeIn(),currentScrollLeft%o.zoomScrollLeft>20||currentScrollLeft>0&&0===o.zoomScrollLeft){o.zoomScrollLeft=currentScrollLeft;var e=o.zoomScrollLeft/o.winWidth,i=Math.ceil(e),r=Math.floor(e);o.zoomImagesLoaded[i]||o.loadZoomImg(i),o.zoomImagesLoaded[r]||o.loadZoomImg(r)}l=!0},200))})},zoomKeyPress:function(){e(document).on("keyup","body",function(e){27==e.which?o.unloadZoom():37==e.which?o.prevNext("previous"):39==e.which&&o.prevNext("next")})},resizeZoom:function(){o.winWidth=e(window).width();var a=o.imgArray.length*o.winWidth;e("#pgzoom").width(a),e(".pgzoomslide").width(o.winWidth);var t=parseInt(o.zoomIdx*o.winWidth);e("#pgzoomscroll").scrollLeft(t)},unloadZoom:function(){e(document).off("keyup","body"),e(window).off("resize",o.resizeZoom),e("#pgzoomscroll").off("scroll"),e("#pgzoomview").fadeOut(function(){e("#pgzoom").empty(),e("#pgzoomview").off("keyup"),e("#pgzoomview").removeClass("fixed")})},prevNext:function(a){var t=e("#pgzoomscroll").scrollLeft()/o.winWidth;o.zoomIdx="previous"==a?Math.round(t)-1:Math.round(t)+1;var l=o.zoomIdx*o.winWidth;e("#pgzoomscroll").stop().animate({scrollLeft:l})}};e.extend(o,a),o.init()}}(jQuery);